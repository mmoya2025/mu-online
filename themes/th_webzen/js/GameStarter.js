gp.Browser=new gp.Util.GetBrowser();gp.GameStarter={_ACTIVEX_Version_Recent:"0940",_ACTIVEX_Version:this._ACTIVEX_Version_Recent,_CountryID:2,_GameID:0,_ServiceID:1,_AuthUseType:1,_XmlUrl:"http://web-wgp.webstarter.webzen.com/StarterInfo.xml",_objStarter:null,_FileCheck:0,_MultiClient:0,_GameStartLogUrl:gp.Http.Portal+"/_Common/GameStartLog.aspx",Exec:function(isFileChk,intGameID,intVer,intServiceID,intAuthUseType,isMultiClient){if(intVer!=undefined){this._ACTIVEX_Version=intVer}if(intGameID!=undefined){this._GameID=intGameID}else{alert("Invalid Game Code");return false}if(intServiceID!=undefined){this._ServiceID=intServiceID}if(intAuthUseType!=undefined){this._AuthUseType=intAuthUseType}if(isFileChk!=undefined){this._FileCheck=isFileChk}if(isMultiClient!=undefined){this._MultiClient=isMultiClient}if(gp.isLive){this._XmlUrl="http://web-wgp.webstarter.webzen.com/StarterInfo.xml"}else{if(gp.isAlpha){this._XmlUrl="http://218.53.141.133/webstarteralpha/starterInfoAlpha.xml"}else{if(gp.isBeta){this._XmlUrl=gp.Http.Platform+"/Files/XML/StarterInfoBeta.xml"}}}if(!this.isSupportedBrowser()){errGameStarterExec(-3);return}if(!gp.Util.IsLogin()){errGameStarterExec(-1);return}var objStarter=this.getGameStartObject();var strParam=this._XmlUrl+"|"+this._GameID+"|"+this._ServiceID+"|"+this._CountryID;if(objStarter==null){this.errGameStarterExec(-4)}else{var IsUpdater=false;var BrowserPlugInRet=null;try{if(gp.Browser.isIE){if(objStarter.CheckElevation){objStarter=objStarter.ElevatedObject();if(objStarter==null){this.errGameStarterExec(40111);return}}}if(typeof objStarter.AvailablePlugIn=="undefined"){var errMsg;switch(gp.Culture.Language){case"fr":errMsg="Erreur: WEBZEN Browser Extension a besoin de votre autorisation pour accéder au navigateur. Autorisez le fonctionnement permanent de l'extension pour pouvoir lancer le jeu.";break;case"de":errMsg="Fehler: Die WEBZEN Browser Extension benötigt Zugriffserlaubnis auf deinen Browser. Bitte wähle „immer ausführen“ aus, um das Spiel starten zu können.";break;case"it":errMsg="Errore: Webzen Browser Extension richiede l'autorizzazione ad accedere al tuo browser. Concedi un'autorizzazione permanente all''extension per lanciare il gioco.";break;case"pl":errMsg="Błąd: Rozszerzenie przeglądarki WEBZEN wymaga udzielenia pozwolenia na uruchomienie. Zezwól witrynie na korzystanie z rozszerzenia, aby móc uruchomić grę.";break;case"pt":errMsg='Erro: A extensão do navegador da WEBZEN requer permissão para rodar em seu navegador. Por favor, permita a extensão "Always Run" para poder iniciar o jogo.';break;case"es":errMsg='Error: La Extension de Browser de WEBZEN requiere permiso para correr en su navegador. Por favor, permita a la Extension "Correr Siempre" para poder lanzar el juego.';break;case"tr":errMsg='Hata: WEBZEN Tarayıcı Uzantısı tarayıcınızda çalışabilmesi için izniniz gerekiyor. Lütfen oyunun çalışabilmesi için Uzantıya "Her Zaman Çalıştır" yetkisini verin. ';break;default:errMsg='Error: WEBZEN Browser Extension requires permission to run on your browser. Please allow the Extension to "Always Run" to be able to launch the game.';break}throw {message:errMsg,type:1}}var StarterXML=gp.Http.Platform+"/Files/XML/WZPlugInListAlpha.xml";if(gp.isLive){StarterXML="http://web-wgp.webstarter.webzen.com/WZPlugInList.XML"}else{if(gp.isAlpha){StarterXML="http://218.53.141.133/webstarteralpha/WZPlugInListAlpha.xml"}else{if(gp.isBeta){StarterXML=gp.Http.Platform+"/Files/XML/WZPlugInListBeta.xml"}}}objStarter.ShowUI=1;objStarter.WriteLog=3;objStarter.PlugInTag="BrowserPlugIn";objStarter.PlugInManager="UpdateManager";objStarter.PlugInListLocation=StarterXML;BrowserPlugInRet=objStarter.AvailablePlugIn()}catch(ex){var em;switch(ex.type){case 1:em=ex.message;break;default:em="ERROR:"+ex.message+(ex.number?"("+ex.number+")":"");break}alert(em);return false}if(40110==BrowserPlugInRet||40100==BrowserPlugInRet){this.errGameStarterExec(-4)}else{if(40000==BrowserPlugInRet){objStarter.ShowUI=1;objStarter.WriteLog=3;objStarter.PlugInTag="GameStarter";objStarter.PlugInManager="UpdateManager";objStarter.PlugInListLocation=StarterXML;BrowserPlugInRet=objStarter.AvailablePlugIn();if(40110==BrowserPlugInRet){BrowserPlugInRet=objStarter.UpdatePlugIn()}}IsUpdater=true}if(IsUpdater){objStarter.ModuleTag="WZGameStart.dll";objStarter.WriteLog=3;objStarter.ModuleInvokeAlias="IsGameClientInstalled";objStarter.ModuleInvokeParam=strParam;BrowserPlugInRet=objStarter.InvokePlugIn();if(40000==BrowserPlugInRet&&!this._MultiClient){objStarter.ModuleTag="WZGameStart.dll";objStarter.ModuleInvokeAlias="IsExecGameClient";objStarter.ModuleInvokeParam=strParam;BrowserPlugInRet=objStarter.InvokePlugIn()}if(40000==BrowserPlugInRet){this.execGameStart(this._GameID,this._ServiceID)}else{if(40113==BrowserPlugInRet||40112==BrowserPlugInRet){this.errGameStarterExec(BrowserPlugInRet)}else{var em="ERROR : Game Starter. Code("+BrowserPlugInRet+")";alert(em)}}}}},isSupportedBrowser:function(){var isbool=false;if(gp.Browser.isIE){isbool=true}if(gp.Browser.isFF){isbool=true}if(gp.Browser.isOP){isbool=true}if(gp.Browser.isSF){isbool=true}if(gp.Browser.isCR){isbool=true}return isbool},getGameStartController:function(){var obj="";if(this._ACTIVEX_Version==undefined){this._ACTIVEX_Version=this._ACTIVEX_Version_Recent}if(gp.Browser.isIE){obj='<object id="WebzenGameStarter" ';obj+='CLASSID="CLSID:27AD4028-716B-4383-B8FA-A94C6CFCEC37"';obj+='width="0" height="0">';obj+="</object>"}else{obj+='<embed id="WebzenGameStarterFX" type="application/x-WZBrowserExt" width="0" height="0" />'}return obj},setGameStartController:function(){var startDiv=document.getElementById("startObject");if(startDiv==null){var obj=document.createElement("div");obj.setAttribute("id","startObject");obj.style.border="0px";obj.style.width="0px";obj.style.height="0px";startDiv=document.body.appendChild(obj)}startDiv.innerHTML=this.getGameStartController()},execGameStart:function(gameID,serviceID){var obj=document.createElement("script");obj.type="text/javascript";obj=document.getElementsByTagName("head")[0].appendChild(obj);obj.src=unescape(top.GameLib._GameStartUrl+"?iGC="+gameID+"&iSC="+serviceID+"&sAV="+this._ACTIVEX_Version+"&ver="+new Date().getTime())},getGameStartObject:function(){if(this._objStarter==null){this.setGameStartController();if(gp.Browser.isIE){if(document.WebzenGameStarter!=null&&typeof(document.WebzenGameStarter)!="undefined"&&document.WebzenGameStarter.object!=null){this._objStarter=document.WebzenGameStarter;objStarter=new ActiveXObject("EPWZCmnCtrl.WZBrowserControl")}}else{var objPlugin=navigator.plugins["WEBZEN Browser Extension"];if(objPlugin!=null){this._objStarter=document.getElementById("WebzenGameStarterFX")}}}return this._objStarter},LauncherExec:function(strAccountGuid,strPiiURL,intGameID,intServiceID,strUserID,SCToken){if(!gp.Util.IsLogin()){this.errGameStarterExec(-1);return}var objStarter=this.getGameStartObject();var strParam=strAccountGuid+"|"+strUserID+"|"+this._XmlUrl+"|"+strPiiURL+"|"+intGameID+"|"+intServiceID+"|"+this._CountryID+"|"+this._AuthUseType+"|"+this._FileCheck+"|"+SCToken;if(gp.Browser.isIE){if(objStarter.CheckElevation){objStarter=objStarter.ElevatedObject();if(objStarter==null){this.errGameStarterExec(40111);return}}}objStarter.ModuleTag="WZGameStart.dll";objStarter.WriteLog=3;objStarter.ModuleInvokeAlias="ExecuteGame";objStarter.ModuleInvokeParam=strParam;var Ret=objStarter.InvokePlugIn();if(Ret==40000){}else{if(40113==Ret||40111==Ret||40103==Ret){this.errGameStarterExec(Ret)}else{var em="ERROR : Game Starter. Code("+Ret+")";alert(em)}}},errGameStarterExec:function(intError){if(intError==-1){alert("로그인 후 이용해 주시기 바랍니다.");return false}else{if(intError==-2){alert("게임 약관 동의 후 이용이 가능합니다.");return false}else{if(intError==-3){alert(gp.Localization.A_G012);return false}else{if(intError==-4){top.GameLib.moveStarterDownLoad();return false}else{if(intError==-6){alert(gp.Localization.A_G007);return false}else{if(intError==-7){alert(gp.Localization.A_G001);return false}else{if(intError==-8){alert(gp.Localization.A_G001);return false}else{if(intError==-9){alert(gp.Localization.A_G010);return false}else{if(intError==-10){alert(gp.Localization.A_G013);return false}else{if(intError==40103){alert(gp.Localization.A_G013);return false}else{if(intError==40111){alert(gp.Localization.A_G014);return false}else{if(intError==40112){alert(gp.Localization.A_G005);return false}else{if(intError==40113){top.GameLib.moveClientDownLoad();return false}else{var em="ERROR : Game Start. Code("+intError+")";alert(em)}}}}}}}}}}}}}},GameStarterLogSave:function(intGameID,intServiceID,strKey,strAccountGuid,intExecResult){var startLog=document.getElementById("startLog");if(startLog==null){var obj=document.createElement("iframe");obj.setAttribute("id","startLog");obj.style.border="0px";obj.style.width="0px";obj.style.height="0px";startLog=document.body.appendChild(obj)}startLog.src=unescape(this._GameStartLogUrl+"?iGC="+intGameID+"&iSC="+intServiceID+"&sAK="+strKey+"&iAG="+Number(strAccountGuid)+"&iER="+Number(intExecResult))}};